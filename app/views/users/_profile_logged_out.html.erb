<div class="container">
  <div class="row">
   <div class="col-sm-4 col-md-4" >
      <div class="row">
        <div class="col-md-8 offset-md-3">
          <% if @user.facebook_picture_url %>
            <%= image_tag @user.facebook_picture_url, class: "img-thumbnail" %>
            <% elsif @user.photo.present? %>
             <%= cl_image_tag @user.photo, :width=>250, :height=>250, :gravity=>"face", :crop=>"fill", class: "img-thumbnail" %>
             <% else %>
              <%= image_tag "https://testapp.letsmuuv.com/assets/img/img_placeholder_user.gif", class: "img-thumbnail" %>
          <% end %>
        </div>
      </div>
   </div>

   <div class="col-sm-8 col-md-8" >
    <h1>Hi, I'm <%= @user.first_name %>!</h2>
    <h4> I live in <%= @user.city %></h4>
    <p><%= @user.about %></p>

    <% if @user.sitter %>
      <div class="pets">
        <h5>I sit the following pets:</h5>
        <%= @user.sitter.pet_type %>
        <%= image_tag "cat.png" %>
        <%= image_tag "dog.png", class: "grayscale" %>
        <%= image_tag "bird.png" %>
        <%= image_tag "snake.png", class: "grayscale" %>
        <%= image_tag "horse.png", class: "grayscale" %>
      </div>
      <div class="fare">
        <h5>Daily fare:</h5>
        <p><%= @user.sitter.fare %> $ / day</p>
      </div>
      <div class="calendar">
        <%= month_calendar do |date| %>
            <strong><a><%= date.strftime("%d") %></a></strong>
        <% end %>
      </div>
      <div class="col-md-4">
        <div id="map" style="width: 100%; height: 600px;"></div>

        <% content_for(:after_js) do %>
          <%= javascript_tag do %>
            $(document).ready(function() {
              var handler = Gmaps.build('Google');

              handler.buildMap({ internal: { id: 'map' } }, function() {

                markers = handler.addMarkers(<%= raw @hash.to_json %>);
                handler.bounds.extendWith(markers);
                handler.fitMapToBounds();
                if (markers.length == 0) {
                  handler.getMap().setZoom(2);
                } else if (markers.length == 1) {
                  handler.getMap().setZoom(14);
                }
              });
            });
          <% end %>
        <% end %>
      </div>
      <%= button_to "Hire this petsitter", new_booking_path, method: :get, params: { id: @user.id }, class: "btn btn-primary" %>
    <% end %>
   </div>
  </div>
</div>

